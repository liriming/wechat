<!DOCTYPE html>
<html>
<head>
    <title>数据</title>

    <meta charset="UTF-8">

    <script src="js/jquery-2.2.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/template.js"></script>
    <script src="js/sys.js"></script>
    <script src="js/date.tools.js"></script>
    <script src="js/x-page-old.js"></script>

    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/common.css" rel="stylesheet"/>

    <style>
        table {
            border: 1px solid #8968CD;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #8968CD;
            padding: 15px;
        }

        td {
            color: green;
        }

        pre {
            padding: 0px;
            border: 0px
        }

        .table-striped > tbody > tr:nth-of-type(odd) {
            background-color: #E0EEEE;
        }

        .table-hover > tbody > tr:hover {
            background-color: #C1FFC1;
        }

        .export {
            height: 40px;
            width: 60px;
        }

        .export {
            height: 40px;
            width: 60px;
        }

        .r1 {
            width: 20px;
            height: 20px
        }

        #sysMain {
            height: 2400px;
            width: 2400px;
            padding-top: 90px;
            text-align: center;
        }

        #fullbg {
            background-color: gray;
            left: 0;
            opacity: 0.5;
            position: absolute;
            top: 0;
            z-index: 3;
            filter: alpha(opacity = 50);
            -moz-opacity: 0.5;
            -khtml-opacity: 0.5;
        }

        #dialog {
            background-color: #fff;
            border: 5px solid rgba(0, 0, 0, 0.4);
            height: 60s0px;
            left: 50%;
            margin: -200px 0 0 -200px;
            padding: 1px;
            position: fixed !important; /* 娴姩瀵硅瘽妗� */
            position: absolute;
            top: 50%;
            width: 400px;
            z-index: 5;
            border-radius: 5px;
            display: none;
        }
    </style>

</head>

<body>
<div align="center">
    <h2 style="color:blue" id="h2"></h2>
    <h3><a href="javascript:void(0)" onclick="aClick()">重置计算时间</a></h3>
    <h5><a href="javascript:void(0)" onclick="bClick()">时间段统计</a></h5>
    <table>
        <tbody>
        <tr>
            <td id="time" colspan="6" style="text-align: center"><font size="5" color="red">近一批号码数据(0)</font></td>
        </tr>
        <tr>
            <td><font color="red"/>总数</td>
            <td><font color="red"/>生存数</td>
            <td><font color="red"/>实名数</td>
            <td><font color="red"/>纯白数</td>
            <td><font color="red"/>封号数</td>
            <td><font color="red"/>需扫码辅助数</td>
        </tr>
        <tr>
            <td id="minTotal" style="text-align: center"><font color="black"/>0</td>
            <td id="minAlive" style="text-align: center"><font color="black"/>0</td>
            <td id="minReal" style="text-align: center"><font color="black"/>0</td>
            <td id="minNReal" style="text-align: center"><font color="black"/>0</td>
            <td id="minDead" style="text-align: center"><font color="black"/>0</td>
            <td id="minSup" style="text-align: center"><font color="black"/>0</td>
        </tr>
        </tbody>
    </table>
</div>
<div align="center">
    <table>
        <tbody>
        <tr>
            <td colspan="2" style="text-align: center"><font size="5" color="black"><b>历史数据</b></font></td>
            <td colspan="2" style="text-align: center"><font size="5" color="black"><b>今天数据</b></font></td>
            <td colspan="2" style="text-align: center"><font size="5" color="black"><b>昨天数据</b></font></td>
        </tr>
        <tr>
            <td>总数</td>
            <td id="hisTotal">0</td>
            <td>总数</td>
            <td id="todayTotal">0</td>
            <td>总数</td>
            <td id="yesTotal">0</td>
        </tr>
        <tr>
            <td><font color="red"/>库存</td>
            <td id="hisStock">0</td>
            <td><font color="red"/>库存</td>
            <td id="todayStock">0</td>
            <td><font color="red"/>库存</td>
            <td id="yesStock">0</td>
        </tr>
        <tr>
            <td>生存数</td>
            <td id="hisAlive">0</td>
            <td>生存数</td>
            <td id="todayAlive">0</td>
            <td>生存数</td>
            <td id="yesAlive">0</td>
        </tr>
        <tr>
            <td>实名数</td>
            <td id="hisReal">0</td>
            <td>实名数</td>
            <td id="todayReal">0</td>
            <td>实名数</td>
            <td id="yesReal">0</td>
        </tr>
        <tr>
            <td>纯白数</td>
            <td id="hisNReal">0</td>
            <td>纯白数</td>
            <td id="todayNReal">0</td>
            <td>纯白数</td>
            <td id="yesNReal">0</td>
        </tr>
        <tr>
            <td>封号数</td>
            <td id="hisDead">0</td>
            <td>封号数</td>
            <td id="todayDead">0</td>
            <td>封号数</td>
            <td id="yesDead">0</td>
        </tr>
        <tr>
            <td>需扫码辅助数</td>
            <td id="hisSup">0</td>
            <td>需扫码辅助数</td>
            <td id="todaySup">0</td>
            <td>需扫码辅助数</td>
            <td id="yesSup">0</td>
        </tr>
        <tr>
            <td>公众号</td>
            <td id="hisG">pphongbao:0<br>hbhb:0<br></td>
            <td>公众号</td>
            <td id="todayG"></td>
            <td>公众号</td>
            <td id="yesG"></td>
        </tr>
        </tbody>
    </table>
</div>
<div align="center">
    <input id="r1" type="radio" class="r1" value="1" name="r" checked="checked"><span><font size="5px" color="#00008b">当天纯白</font></span></input><br>
    <input id="r2" type="radio" class="r1" value="2" name="r"><span><font size="5px"
                                                                          color="#00008b">隔天纯白</font></span></input><br>
    <input id="r3" type="radio" class="r1" value="3" name="r"><span><font size="5px"
                                                                          color="#00008b">当天实名</font></span></input><br>
    <input id="r4" type="radio" class="r1" value="4" name="r"><span><font size="5px"
                                                                          color="#00008b">隔天实名</font></span></input>
    <!--<h3><font size="5" color="red">请输入密码</font></h3>
    <input type="password" id="psw" value=""><br><br>
    <button type="button" class="export" onclick="exportData()">导出</button>
    <br>-->
</div>
<div id="sysMain"></div>
</body>


<script id="hourCountListTpl" type="text/html">
    <table class="table table-striped table-condensed table-hover">
        <tbody>
        <tr>
            <th>小时</th>
            <th>数量</th>
        </tr>
        {{each results as item i}}
        <tr>
            <td>{{item.Hour}}时</td>
            <td>{{item.Count}}</td>
        </tr>
        {{/each}}
        </tbody>
    </table>
</script>

<script>
    $(function () {
        //加的效果
        $(".add").click(function () {
            var n = $(this).prev().val();
            var num = parseInt(n) + 1;
            if (num == 0) {
                return;
            }
            $(this).prev().val(num);
        });
        //减的效果
        $(".sub").click(function () {
            var n = $(this).next().val();
            var num = parseInt(n) - 1;
            if (num == 0) {
                return
            }
            $(this).next().val(num);
        });
        getMsg();
    });

    function getMsg() {
        $.ajax({
            type: "GET",
            url: "/wc/statistics",
            data: null,
            dataType: "json",
            success: function (result) {
                $("#hisTotal").html(result.hisTotal);
                $("#todayTotal").html(result.todayTotal);
                $("#yesTotal").html(result.yesTotal);
                $("#hisAlive").html(result.hisAlive);
                $("#todayAlive").html(result.todayAlive);
                $("#yesAlive").html(result.yesAlive);
                $("#hisDead").html(result.hisDead);
                $("#todayDead").html(result.todayDead);
                $("#yesDead").html(result.yesDead);
                $("#hisReal").html(result.hisReal);
                $("#todayReal").html(result.todayReal);
                $("#yesReal").html(result.yesReal);
                $("#hisNReal").html(result.hisNReal);
                $("#todayNReal").html(result.todayNReal);
                $("#yesNReal").html(result.yesNReal);
                $("#hisStock").html(result.hisStock);
                $("#todayStock").html(result.todayStock);
                $("#yesStock").html(result.yesStock);
                $("#hisSup").html(result.hisSup);
                $("#todaySup").html(result.todaySup);
                $("#yesSup").html(result.yesSup);
                $("#hisG").html(result.hisG);
                $("#todayG").html(result.todayG);
                $("#yesG").html(result.yesG);

                $("#minAlive").html(result.minAlive);
                $("#minDead").html(result.minDead);
                $("#minNReal").html(result.minNReal);
                $("#minReal").html(result.minReal);
                $("#minSup").html(result.minSup);
                $("#minTotal").html(result.minTotal);

                $("#h2").html("剩余可用号码数量：" + result.resPhoneNum);


                $("#r1").next("span").html("<font size='5px' color='#00008b'>当天纯白(" + result.todayWhiteNum + ")</font>")
                $("#r3").next("span").html("<font size='5px' color='#00008b'>当天实名(" + result.todayRealNum + ")</font>")
                $("#r2").next("span").html("<font size='5px' color='#00008b'>隔天纯白(" + result.yesWhiteNum + ")</font>")
                $("#r4").next("span").html("<font size='5px' color='#00008b'>隔天实名(" + result.yesRealNum + ")</font>")

                $("#time").html("<font size='5px' color='red'>近一批号码数据(" + result.countTime + ")</font>")
            }
        });
    }

    
    function aClick() {
        var aConfirm = confirm("重置之后近一批号码统计数据将会清零，确认吗？");
        if (aConfirm == true) {
            $.ajax({
                type: "GET",
                url: "/wc/uploadCountTime",
                data: null,
                dataType: "json"
            })
            location.replace(document.referrer);
        }
    }

    function bClick() {
        $.ajax({
            type: "GET",
            url: "/wc/getHourCount",
            data: null,
            dataType: "json",
            success: function(result){
                var html = getHourCountCallback(result);
                $("#sysMain").empty();
                $("#sysMain").append(html);
                var bh = $("body").height();
                var bw = $("body").width();
                $("#fullbg").css({
                    height : bh,
                    width : bw,
                    display : "block"
                });
                $("#dialog").show();
            }

        });
    }

    function getHourCountCallback(result) {
        resultList = result
        if (resultList.length == 0) {
            return;
        }
        var html = template('hourCountListTpl', result);

        return getHourCountHtml(html);
    }

    function getHourCountHtml(html) {
        return "<div id='fullbg'></div> "
            + "<div id='dialog'> "
            + "<p class='close'><a href='#' onclick='closeBg();'>关闭</a></p> "
            + html
            + "</div> ";
    }

    //关闭灰色 jQuery 遮罩
    function closeBg() {
        $("#fullbg,#dialog").hide();
    }
    

</script>

</html>
